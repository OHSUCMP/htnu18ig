{
  "resourceType": "Library",
  "id": "library-NonPharmacologicIntervention",
  "extension": [ {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem",
    "valueReference": {
      "reference": "cqf-tooling"
    }
  } ],
  "url": "http://fhir.org/guides/ohsu/htnu18ig/Library/NonPharmacologicIntervention",
  "version": "0.1",
  "name": "NonPharmacologicIntervention",
  "relatedArtifact": [ {
    "type": "depends-on",
    "resource": "http://hl7.org/fhir/Library/FHIR-ModelInfo|4.0.1"
  }, {
    "type": "depends-on",
    "resource": "http://hl7.org/fhir/Library/FHIRHelpers|4.0.1"
  }, {
    "type": "depends-on",
    "resource": "http://fhir.org/guides/ohsu/htnu18ig/Library/OHSUHTNCommon|0.1"
  }, {
    "type": "depends-on",
    "resource": "http://terminology.hl7.org/CodeSystem/v3-ActCode"
  }, {
    "type": "depends-on",
    "resource": "http://loinc.org"
  }, {
    "type": "depends-on",
    "resource": "http://terminology.hl7.org/CodeSystem/goal-achievement"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.3157.4012"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1032.10"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.2012"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1104.2"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.2.1045"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.509"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.420"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1195.111"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1032.124"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.195.12.1003"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1146.1330"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.2.422"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.1.1490"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.106.11.1030"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.378"
  }, {
    "type": "depends-on",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.2.590"
  } ],
  "parameter": [ {
    "name": "Patient",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Patient"
  }, {
    "name": "Info",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Warning",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Critical",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Errors",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Any"
  }, {
    "name": "Patient Name",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Condition Indicating Preexisting Hypertension",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Condition"
  }, {
    "name": "Meets Inclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient Under Age 18",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient Over Age 80",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Condition Indicating End Stage Renal Disease",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Condition"
  }, {
    "name": "Condition Indicating Pregnancy",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Condition"
  }, {
    "name": "Meets Exclusion Criteria",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "In Population",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "BP Goal Recommendation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "BP Goal Rationale",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Smoking Recommendation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Smoking Rationale",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "BMI Recommendation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "BMI Rationale",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Alcohol Recommendation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Alcohol Rationale",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Dietary Counseling Recommendation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Dietary Counseling Rationale",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Smoking, Drinking, BMI Not Increased Recommendation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Smoking, Drinking, BMI Not Increased Rationale",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Qualifying Blood Pressure Goals",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Goal"
  }, {
    "name": "Most Recently Established Blood Pressure Goal",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Goal"
  }, {
    "name": "BP Goal Demonstrating Patient Improvement",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Goal"
  }, {
    "name": "Patient at BP Goal",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient on Track of Goal Recommendation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Patient on Track of Goal Rationale",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Indicator Status",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Exclusion Reason",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "string"
  }, {
    "name": "Patient does not have a BP Goal",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Observations Indicating Patient is a Smoker",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Most Recent Observation of Patient Smoking Status",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Observation"
  }, {
    "name": "Patient is Currently a Smoker",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Observations Specifying Patient BMI",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Most Recent Patient BMI",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Observation"
  }, {
    "name": "Patient BMI is Greater than 25 kg/m2",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Observations Measuring Amount of Alcoholic Drinks Patient has per Drinking Day",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Observation"
  }, {
    "name": "Most Recent Patient Drinking Observation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Observation"
  }, {
    "name": "Heavy Daily Drinker",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "decimal"
  }, {
    "name": "Patient is a Heavy Alcoholic Drinker",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Counseling for Non-Pharmacological Interventions",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Procedure"
  }, {
    "name": "Counseling from Last Visit",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Reference"
  }, {
    "name": "Counseling Smoking Observation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Observation"
  }, {
    "name": "Counseling Drinking Observation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Observation"
  }, {
    "name": "Counseling BMI Observation",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Observation"
  }, {
    "name": "Patient Smoking Increased Since Last Visit",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient Drinking Increased Since Last Visit",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient BMI Increased Since Last Visit",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient Has Not Increased in Smoking, BMI, Or Drinking Since Last Counseling",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient is Currently a Smoker Action Path",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient BMI is Greater than 25 kg/m2 Action Path",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient is a Heavy Alcoholic Drinker Action Path",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient is in Need of Dietary Counseling Action Path",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "Patient Reminder Recommendations Action Path",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "boolean"
  }, {
    "name": "TEST Patient Age",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "integer"
  }, {
    "name": "TEST Patient BMI Resources",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "id"
  }, {
    "name": "TEST Most Recent Patient BMI",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Any"
  } ],
  "dataRequirement": [ {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.3157.4012"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1032.10"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.2.590"
    } ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Condition" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.378"
    } ]
  }, {
    "type": "Goal",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Goal" ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1146.1330"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.600.1.1490"
    } ]
  }, {
    "type": "Observation",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Observation" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.106.11.1030"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.509"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1116.420"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1195.111"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1032.124"
    } ]
  }, {
    "type": "Procedure",
    "profile": [ "http://hl7.org/fhir/StructureDefinition/Procedure" ],
    "codeFilter": [ {
      "path": "code",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.195.12.1003"
    } ]
  } ],
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBOb25QaGFybWFjb2xvZ2ljSW50ZXJ2ZW50aW9uIHZlcnNpb24gJzAuMScKCnVzaW5nIEZISVIgdmVyc2lvbiAnNC4wLjEnCgppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuMC4xJyBjYWxsZWQgRkhJUkhlbHBlcnMKaW5jbHVkZSBPSFNVSFROQ29tbW9uIHZlcnNpb24gJzAuMScgY2FsbGVkIENvbW1vbgoKY29kZXN5c3RlbSAidjMgQ29kZSBTeXN0ZW0gQWN0Q29kZSI6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL3YzLUFjdENvZGUnCmNvZGVzeXN0ZW0gIkxPSU5DIjogJ2h0dHA6Ly9sb2luYy5vcmcnCmNvZGVzeXN0ZW0gIkdvYWwgYWNoaWV2ZW1lbnQgc3RhdHVzIjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vZ29hbC1hY2hpZXZlbWVudCcKCi8qIEluY2x1c2lvbiAqLwovLyBIWVBFUlRFTlNJT04gRElBR05PU0lTCnZhbHVlc2V0ICJIeXBlcnRlbnNpb24iOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuMzE1Ny40MDEyJwp2YWx1ZXNldCAiTm9uIGVzc2VudGlhbCBIeXBlcnRlbnNpb24gU05PTUVEQ1QiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMDMyLjEwJwovLyBCTE9PRCBQUkVTU1VSRQp2YWx1ZXNldCAiQmxvb2QgUHJlc3N1cmUgTWVhc3VyZWQiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuNjAwLjIwMTInCnZhbHVlc2V0ICJTeXN0b2xpYyBibG9vZCBwcmVzc3VyZSI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjExMDQuMicKdmFsdWVzZXQgIkRpYXN0b2xpYyBCbG9vZCBQcmVzc3VyZSI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM4ODMuMy41MjYuMi4xMDQ1JwovLyBDT1VOU0VMSU5HCnZhbHVlc2V0ICJUb2JhY2NvIFVzZSBDZXNzYXRpb24gQ291bnNlbGluZyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM4ODMuMy41MjYuMy41MDknCnZhbHVlc2V0ICJXZWlnaHQgUmVkdWN0aW9uIFJlY29tbWVuZGF0aW9ucyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjExMTYuNDIwJwp2YWx1ZXNldCAiQk1JIEZvbGxvdyBVcCBQbGFuIFNOT01FRENUIjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTE5NS4xMTEnCnZhbHVlc2V0ICJBbGNvaG9sIEJyaWVmIEludGVydmVudGlvbiBhbmQgQ291bnNlbGluZyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjEwMzIuMTI0Jwp2YWx1ZXNldCAiQ291bnNlbGluZyBmb3IgTnV0cml0aW9uIjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzg4My4zLjQ2NC4xMDAzLjE5NS4xMi4xMDAzJwovLyBTTU9LSU5HCnZhbHVlc2V0ICJUb2JhY2NvIFNtb2tpbmcgU3RhdHVzIFtDdXJyZW50XSAoU29jaWFsIEhpc3RvcnkpIChMT0lOQykiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMTQ2LjEzMzAnCnZhbHVlc2V0ICJUb2JhY2NvIFVzZXIiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuNTI2LjIuNDIyJwovLyBCTUkKdmFsdWVzZXQgIkJNSSBSYXRpbyI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM4ODMuMy42MDAuMS4xNDkwJwovLyBBTENPSE9MCnZhbHVlc2V0ICJBdmVyYWdlIE51bWJlciBvZiBEcmlua3MgcGVyIERyaW5raW5nIERheSI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM4ODMuMy40NjQuMTAwMy4xMDYuMTEuMTAzMCcKCi8qIEV4Y2x1c2lvbiAqLwp2YWx1ZXNldCAiUHJlZ25hbmN5IjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzg4My4zLjUyNi4zLjM3OCcKdmFsdWVzZXQgIkVuZCBTdGFnZSBSZW5hbCBEaXNlYXNlIjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzg4My4zLjUyNi4yLjU5MCcKCgpjb2RlICJQQUNLUyBBIERBWSI6ICc4NjYzLTcnIGZyb20gIkxPSU5DIiBkaXNwbGF5ICdDaWdhcmV0dGVzIHNtb2tlZCBjdXJyZW50IChwYWNrIHBlciBkYXkpIC0gUmVwb3J0ZWQnCmNvZGUgImluLXByb2dyZXNzIjogJ2luLXByb2dyZXNzJyBmcm9tICJHb2FsIGFjaGlldmVtZW50IHN0YXR1cyIgZGlzcGxheSAnSW4gUHJvZ3Jlc3MnCmNvZGUgImltcHJvdmluZyI6ICdpbXByb3ZpbmcnIGZyb20gIkdvYWwgYWNoaWV2ZW1lbnQgc3RhdHVzIiBkaXNwbGF5ICdJbXByb3ZpbmcnCmNvZGUgImFjaGlldmVkIjogJ2FjaGlldmVkJyBmcm9tICJHb2FsIGFjaGlldmVtZW50IHN0YXR1cyIgZGlzcGxheSAnQWNoaWV2ZWQnCmNvZGUgInN1c3RhaW5pbmciOiAnc3VzdGFpbmluZycgZnJvbSAiR29hbCBhY2hpZXZlbWVudCBzdGF0dXMiIGRpc3BsYXkgJ3N1c3RhaW5pbmcnCgoKY29udGV4dCBQYXRpZW50CgpkZWZpbmUgZnVuY3Rpb24gIlBhY2tzIFBlciBEYXkiKE8gRkhJUi5PYnNlcnZhdGlvbik6CiAgRkhJUkhlbHBlcnMuVG9RdWFudGl0eShzaW5nbGV0b24gZnJvbSAoTy5jb21wb25lbnQgQyB3aGVyZSBDLmNvZGUgPSAiUEFDS1MgQSBEQVkiKS52YWx1ZSkKCmRlZmluZSAiSW5mbyI6CiAgJ2luZm8nCgpkZWZpbmUgIldhcm5pbmciOgogICd3YXJuaW5nJwoKZGVmaW5lICJDcml0aWNhbCI6CiAgJ2NyaXRpY2FsJwoKZGVmaW5lICJFcnJvcnMiOgogIG51bGwKCmRlZmluZSAiUGF0aWVudCBOYW1lIjoKICBGaXJzdChQYXRpZW50Lm5hbWUuZ2l2ZW4pCiAgICsgJyAnICsKICBGaXJzdChQYXRpZW50Lm5hbWUuZmFtaWx5KQoKCi8qIFJlY29tbWVuZGF0aW9uIENyaXRlcmlhIC0gTm9uLVBoYXJtYWNvbG9naWMgSW50ZXJ2ZW50aW9ucyAgKi8KZGVmaW5lICJNZWV0cyBJbmNsdXNpb24gQ3JpdGVyaWEiOgogIGV4aXN0cyAiQ29uZGl0aW9uIEluZGljYXRpbmcgUHJlZXhpc3RpbmcgSHlwZXJ0ZW5zaW9uIgoKZGVmaW5lICJNZWV0cyBFeGNsdXNpb24gQ3JpdGVyaWEiOgogICJQYXRpZW50IFVuZGVyIEFnZSAxOCIKICAgIG9yICJQYXRpZW50IE92ZXIgQWdlIDgwIgogICAgb3IgZXhpc3RzICJDb25kaXRpb24gSW5kaWNhdGluZyBFbmQgU3RhZ2UgUmVuYWwgRGlzZWFzZSIKICAgIG9yIGV4aXN0cyAiQ29uZGl0aW9uIEluZGljYXRpbmcgUHJlZ25hbmN5IgoKZGVmaW5lICJJbiBQb3B1bGF0aW9uIjoKICAiTWVldHMgSW5jbHVzaW9uIENyaXRlcmlhIgogIGFuZCBub3QgIk1lZXRzIEV4Y2x1c2lvbiBDcml0ZXJpYSIKCi8vIFNlcGFyYXRlIEFjdGlvbnMgZm9yIGVhY2ggRGVjaXNpb24gUG9pbnQgT3V0cHV0LiBTZXBhcmF0ZSBEZWZpbml0aW9ucyBmb3IgQWN0aW9uIENvbmRpdGlvbnMuCmRlZmluZSAiQlAgR29hbCBSZWNvbW1lbmRhdGlvbiI6CiAgJ0Rpc2N1c3MgdGFyZ2V0IGJsb29kIHByZXNzdXJlIGFuZCBzZXQgaW5pdGlhbCBCUCBnb2FsJwoKZGVmaW5lICJCUCBHb2FsIFJhdGlvbmFsZSI6CiAgJ1RPRE8nCgpkZWZpbmUgIlNtb2tpbmcgUmVjb21tZW5kYXRpb24iOgogICdSZWNvbW1lbmQgc21va2luZyBjZXNzYXRpb24gY291bnNlbGluZycKCmRlZmluZSAiU21va2luZyBSYXRpb25hbGUiOgogICdUT0RPJwoKZGVmaW5lICJCTUkgUmVjb21tZW5kYXRpb24iOgogICdSZWNvbW1lbmQgd2VpZ2h0IGxvc3MgY291bnNlbGluZy4nCgpkZWZpbmUgIkJNSSBSYXRpb25hbGUiOgogICdUT0RPJwoKZGVmaW5lICJBbGNvaG9sIFJlY29tbWVuZGF0aW9uIjoKICAnUHJvdmlkZSBhbGNvaG9sIG1vZGVyYXRpb24gY291bnNlbGluZycKCmRlZmluZSAiQWxjb2hvbCBSYXRpb25hbGUiOgogICdUT0RPJwoKZGVmaW5lICJEaWV0YXJ5IENvdW5zZWxpbmcgUmVjb21tZW5kYXRpb24iOgogICdQcm92aWRlIGRpZXRhcnkgY291bnNlbGluZywgaW5jbHVkaW5nIHNhbHQvc29kaXVtIHJlZHVjdGlvbiwgYXMgd2VsbCBhcyBjb3Vuc2VsaW5nIHJlZ2FyZGluZyBwaHlzaWNhbCBhY3Rpdml0eScKCmRlZmluZSAiRGlldGFyeSBDb3Vuc2VsaW5nIFJhdGlvbmFsZSI6CiAgJ1RPRE8nCgpkZWZpbmUgIlNtb2tpbmcsIERyaW5raW5nLCBCTUkgTm90IEluY3JlYXNlZCBSZWNvbW1lbmRhdGlvbiI6CiAgJ1Byb3ZpZGUgUmVtaW5kZXIgb2YgcmVjb21tZW5kYXRpb25zLicKCmRlZmluZSAiU21va2luZywgRHJpbmtpbmcsIEJNSSBOb3QgSW5jcmVhc2VkIFJhdGlvbmFsZSI6CiAgJ1RPRE8nCgpkZWZpbmUgIlBhdGllbnQgb24gVHJhY2sgb2YgR29hbCBSZWNvbW1lbmRhdGlvbiI6CiAgaWYgIlBhdGllbnQgYXQgQlAgR29hbCIgdGhlbiAnUGF0aWVudCBvbiB0cmFjayBvZiBnb2FsOiBFbmQgb2Ygbm9uLXBoYXJtYWNvbG9naWMgaW50ZXJ2ZW50aW9ucy4nCiAgZWxzZSAnUGF0aWVudCBub3Qgb24gdHJhY2sgb2YgZ29hbDogRGlzY3VzcyBwaGFybWFjb2xvZ2ljYWwgaW50ZXJ2ZW50aW9ucy4nCgpkZWZpbmUgIlBhdGllbnQgb24gVHJhY2sgb2YgR29hbCBSYXRpb25hbGUiOgogIGlmICJQYXRpZW50IGF0IEJQIEdvYWwiIHRoZW4gJ1BhdGllbnQgb24gdHJhY2sgb2YgZ29hbDogTm8gRnVydGhlciBBY3Rpb24gUmVxdWlyZWQuJwogIGVsc2UgJ1BhdGllbnQgbm90IG9uIHRyYWNrIG9mIGdvYWw6IERpc2N1c3MgcGhhcm1hY29sb2dpY2FsIHRyZWF0bWVudCBvcHRpb25zIHdpdGggUGF0aWVudC4nCgpkZWZpbmUgIkluZGljYXRvciBTdGF0dXMiOgogICJJbmZvIgoKZGVmaW5lICJFeGNsdXNpb24gUmVhc29uIjoKICBpZiAiTWVldHMgRXhjbHVzaW9uIENyaXRlcmlhIiB0aGVuCiAgICAoCiAgICAgICdQYXRpZW50IHdhcyBleGNsdWRlZCBmcm9tIG5vbi1waGFybWFjb2xvZ2ljIGludGVydmVudGlvbnMgZm9yIGh5cGVydGVuc2lvbiBkdWUgdG8gJwogICAgICArICgKICAgICAgICAgIGlmICJQYXRpZW50IFVuZGVyIEFnZSAxOCIgdGhlbiAnYmVpbmcgdW5kZXIgdGhlIGFnZSBvZiAxOC4nCiAgICAgICAgICBlbHNlIGlmICJQYXRpZW50IE92ZXIgQWdlIDgwIiB0aGVuICdiZWluZyBvdmVyIHRoZSBhZ2Ugb2YgODAuJwogICAgICAgICAgZWxzZSBpZiBleGlzdHMgIkNvbmRpdGlvbiBJbmRpY2F0aW5nIEVuZCBTdGFnZSBSZW5hbCBEaXNlYXNlIiB0aGVuICdoYXZpbmcgZW5kIHN0YWdlIHJlbmFsIGRpc2Vhc2UuJwogICAgICAgICAgZWxzZSBpZiBleGlzdHMgIkNvbmRpdGlvbiBJbmRpY2F0aW5nIFByZWduYW5jeSIgdGhlbiAnYmVpbmcgcHJlZ25hbnQuJwogICAgICAgICAgZWxzZSAnJwogICAgICAgICkKICAgICkKICBlbHNlICcnCgoKLyogTm9uLVBoYXJtYWNvbG9naWMgSW50ZXJ2ZW50aW9ucyBXb3JrZmxvdyAqLwovLyBEaWFnbm9zaXMgb2YgSFROIGluIFByb2JsZW0gTGlzdC4KZGVmaW5lICJDb25kaXRpb24gSW5kaWNhdGluZyBQcmVleGlzdGluZyBIeXBlcnRlbnNpb24iOgogICgKICAgIChDb21tb24uUXVhbGlmaWVkQ29uZGl0aW9uKFsiQ29uZGl0aW9uIjogIkh5cGVydGVuc2lvbiJdKSkKICAgIHVuaW9uIChDb21tb24uUXVhbGlmaWVkQ29uZGl0aW9uKFsiQ29uZGl0aW9uIjogIk5vbiBlc3NlbnRpYWwgSHlwZXJ0ZW5zaW9uIFNOT01FRENUIl0pKQogICkgUHJlZXhpc3RpbmdDb25kaXRpb24KCgovLyBEb2VzIFBhdGllbnQgaGF2ZSBhIEJQIEdvYWw/CmRlZmluZSAiUXVhbGlmeWluZyBCbG9vZCBQcmVzc3VyZSBHb2FscyI6CiAgKENvbW1vbi5RdWFsaWZpZWRHb2FsKFsiR29hbCJdKSkgQlBHb2FsCiAgICB3aGVyZSAoCiAgICAgIHNpbmdsZXRvbiBmcm9tIChCUEdvYWwudGFyZ2V0IFN5c3RvbGljCiAgICAgICAgd2hlcmUgU3lzdG9saWMubWVhc3VyZSBpbiAiU3lzdG9saWMgYmxvb2QgcHJlc3N1cmUiCiAgICAgICAgICBhbmQgU3lzdG9saWMuZGV0YWlsIGlzIFF1YW50aXR5CiAgICAgICAgICBhbmQgQ29tbW9uLldpdGhVbml0KFN5c3RvbGljLmRldGFpbCwgJ21tW0hnXScpKQogICAgKSBTeXN0b2xpY1RhcmdldCBpcyBub3QgbnVsbAogICAgICBhbmQgKAogICAgICAgIHNpbmdsZXRvbiBmcm9tIChCUEdvYWwudGFyZ2V0IERpYXN0b2xpYwogICAgICAgICAgd2hlcmUgRGlhc3RvbGljLm1lYXN1cmUgaW4gIkRpYXN0b2xpYyBCbG9vZCBQcmVzc3VyZSIKICAgICAgICAgICAgYW5kIERpYXN0b2xpYy5kZXRhaWwgaXMgUXVhbnRpdHkKICAgICAgICAgICAgYW5kIENvbW1vbi5XaXRoVW5pdChEaWFzdG9saWMuZGV0YWlsLCAnbW1bSGddJykpCiAgICAgICkgRGlhc3RvbGljVGFyZ2V0IGlzIG5vdCBudWxsCgpkZWZpbmUgIk1vc3QgUmVjZW50bHkgRXN0YWJsaXNoZWQgQmxvb2QgUHJlc3N1cmUgR29hbCI6CiAgTGFzdCAoCiAgICAiUXVhbGlmeWluZyBCbG9vZCBQcmVzc3VyZSBHb2FscyIgQlBHb2FsCiAgICAgIHNvcnQgYnkgKHN0YXJ0IGFzIGRhdGUpCiAgKQoKZGVmaW5lICJQYXRpZW50IGRvZXMgbm90IGhhdmUgYSBCUCBHb2FsIjoKICBpZiAiSW4gUG9wdWxhdGlvbiIgaXMgbm90IHRydWUgdGhlbgogICAgZmFsc2UKICBlbHNlCiAgICBub3QgZXhpc3RzICJRdWFsaWZ5aW5nIEJsb29kIFByZXNzdXJlIEdvYWxzIgoKLy8gQWxsIG9ic2VydmF0aW9ucyBwZXJ0YWluaW5nIHRvIHNtb2tpbmcKZGVmaW5lICJTbW9raW5nIFN0YXR1cyBPYnNlcnZhdGlvbnMiOgogIChDb21tb24uUXVhbGlmaWVkT2JzZXJ2YXRpb24oWyJPYnNlcnZhdGlvbiI6ICJUb2JhY2NvIFNtb2tpbmcgU3RhdHVzIFtDdXJyZW50XSAoU29jaWFsIEhpc3RvcnkpIChMT0lOQykiXSkpCgovLyBBbGwgb2JzZXJ2YXRpb25zIGluZGljYXRpbmcgcGF0aWVudCBpcyBhIHNtb2tlcgpkZWZpbmUgIk9ic2VydmF0aW9ucyBJbmRpY2F0aW5nIFBhdGllbnQgaXMgYSBTbW9rZXIiOgogICJTbW9raW5nIFN0YXR1cyBPYnNlcnZhdGlvbnMiIFNtb2tpbmdTdGF0dXMKICAgIHdoZXJlIFNtb2tpbmdTdGF0dXMudmFsdWUgYXMgQ29kZWFibGVDb25jZXB0IGluICJUb2JhY2NvIFVzZXIiCiAgICAgIGFuZCBzaW5nbGV0b24gZnJvbSAoCiAgICAgICAgU21va2luZ1N0YXR1cy5jb21wb25lbnQgQwogICAgICAgICAgd2hlcmUgRkhJUkhlbHBlcnMuVG9Db25jZXB0KEMuY29kZSkgfiAiUEFDS1MgQSBEQVkiCiAgICAgICAgICAgIGFuZCBDLnZhbHVlIGlzIFF1YW50aXR5IGFuZCBDb21tb24uV2l0aFVuaXQoQy52YWx1ZSwgJ1BhY2tzL0RheScpCiAgICAgICkgaXMgbm90IG51bGwKCmRlZmluZSAiTW9zdCBSZWNlbnQgT2JzZXJ2YXRpb24gb2YgUGF0aWVudCBTbW9raW5nIFN0YXR1cyI6CiAgTGFzdCgKICAgICJTbW9raW5nIFN0YXR1cyBPYnNlcnZhdGlvbnMiIFNtb2tpbmdPYnNlcnZlZAogICAgc29ydCBieSBDb2FsZXNjZShlbmQgb2YgQ29tbW9uLiJOb3JtYWxpemUgSW50ZXJ2YWwiKGVmZmVjdGl2ZSksIGlzc3VlZCkKICApCgpkZWZpbmUgIlBhdGllbnQgaXMgQ3VycmVudGx5IGEgU21va2VyIjoKICBpZiAiSW4gUG9wdWxhdGlvbiIgaXMgbm90IHRydWUgdGhlbgogICAgZmFsc2UKICBlbHNlCiAgICAiT2JzZXJ2YXRpb25zIEluZGljYXRpbmcgUGF0aWVudCBpcyBhIFNtb2tlciIgY29udGFpbnMgIk1vc3QgUmVjZW50IE9ic2VydmF0aW9uIG9mIFBhdGllbnQgU21va2luZyBTdGF0dXMiCgovLyBJcyBwYXRpZW50J3MgQk1JID4gMjU/CmRlZmluZSAiT2JzZXJ2YXRpb25zIFNwZWNpZnlpbmcgUGF0aWVudCBCTUkiOgogIChDb21tb24uUXVhbGlmaWVkT2JzZXJ2YXRpb24oWyJPYnNlcnZhdGlvbiI6ICJCTUkgUmF0aW8iXSkpIEJNSU9ic2VydmVkCiAgICB3aGVyZSBCTUlPYnNlcnZlZC52YWx1ZSBpcyBRdWFudGl0eQogICAgICBhbmQgQ29tbW9uLldpdGhVbml0KEJNSU9ic2VydmVkLnZhbHVlLCAna2cvbTInKQoKZGVmaW5lICJNb3N0IFJlY2VudCBQYXRpZW50IEJNSSI6CiAgTGFzdCgKICAgICJPYnNlcnZhdGlvbnMgU3BlY2lmeWluZyBQYXRpZW50IEJNSSIgQk1JT2JzZXJ2ZWQKICAgIHNvcnQgYnkgQ29hbGVzY2UoZW5kIG9mIENvbW1vbi4iTm9ybWFsaXplIEludGVydmFsIihlZmZlY3RpdmUpLCBpc3N1ZWQpCiAgKQoKZGVmaW5lICJQYXRpZW50IEJNSSBpcyBHcmVhdGVyIHRoYW4gMjUga2cvbTIiOgogIGlmICJJbiBQb3B1bGF0aW9uIiBpcyBub3QgdHJ1ZSB0aGVuCiAgICBmYWxzZQogIGVsc2UKICAgICJNb3N0IFJlY2VudCBQYXRpZW50IEJNSSIudmFsdWUgPj0gMjUuMCAna2cvbTInCgoKLy8gRG9lcyBwYXRpZW50IGRyaW5rIGhlYXZpbHk/CmRlZmluZSAiT2JzZXJ2YXRpb25zIE1lYXN1cmluZyBBbW91bnQgb2YgQWxjb2hvbGljIERyaW5rcyBQYXRpZW50IGhhcyBwZXIgRHJpbmtpbmcgRGF5IjoKICAoQ29tbW9uLlF1YWxpZmllZE9ic2VydmF0aW9uKFsiT2JzZXJ2YXRpb24iOiAiQXZlcmFnZSBOdW1iZXIgb2YgRHJpbmtzIHBlciBEcmlua2luZyBEYXkiXSkpIERyaW5rc1BlckRheQogICAgd2hlcmUgRHJpbmtzUGVyRGF5LnZhbHVlIGlzIFF1YW50aXR5CiAgICAgIGFuZCBDb21tb24uV2l0aFVuaXQoRHJpbmtzUGVyRGF5LnZhbHVlLCAnRHJpbmtzL0RheScpCgpkZWZpbmUgIk1vc3QgUmVjZW50IFBhdGllbnQgRHJpbmtpbmcgT2JzZXJ2YXRpb24iOgogIExhc3QoCiAgICAiT2JzZXJ2YXRpb25zIE1lYXN1cmluZyBBbW91bnQgb2YgQWxjb2hvbGljIERyaW5rcyBQYXRpZW50IGhhcyBwZXIgRHJpbmtpbmcgRGF5IiBEcmlua3NQZXJEYXkKICAgIHNvcnQgYnkgQ29hbGVzY2UoZW5kIG9mIENvbW1vbi4iTm9ybWFsaXplIEludGVydmFsIihlZmZlY3RpdmUpLCBpc3N1ZWQpCiAgKQoKZGVmaW5lICJIZWF2eSBEYWlseSBEcmlua2VyIjoKICBpZiBQYXRpZW50LmdlbmRlciA9ICdtYWxlJyB0aGVuIDUuMAogIGVsc2UgNC4wCgpkZWZpbmUgIlBhdGllbnQgaXMgYSBIZWF2eSBBbGNvaG9saWMgRHJpbmtlciI6CiAgaWYgIkluIFBvcHVsYXRpb24iIGlzIG5vdCB0cnVlIHRoZW4KICAgIGZhbHNlCiAgZWxzZQogICAgIk1vc3QgUmVjZW50IFBhdGllbnQgRHJpbmtpbmcgT2JzZXJ2YXRpb24iLnZhbHVlLnZhbHVlID49ICJIZWF2eSBEYWlseSBEcmlua2VyIgoKCi8vIEhhcyBQYXRpZW50IHJlY2VpdmVkIG5vbi1waGFybWFjb2xvZ2ljYWwgaW5zdHJ1Y3Rpb25zIHByZXZpb3VzbHk/CmRlZmluZSAiQ291bnNlbGluZyBmb3IgTm9uLVBoYXJtYWNvbG9naWNhbCBJbnRlcnZlbnRpb25zIjoKICAoCiAgICBDb21tb24uUXVhbGlmaWVkUHJvY2VkdXJlKFsiUHJvY2VkdXJlIjogIlRvYmFjY28gVXNlIENlc3NhdGlvbiBDb3Vuc2VsaW5nIl0pCiAgICB1bmlvbiBDb21tb24uUXVhbGlmaWVkUHJvY2VkdXJlKFsiUHJvY2VkdXJlIjogIldlaWdodCBSZWR1Y3Rpb24gUmVjb21tZW5kYXRpb25zIl0pCiAgICB1bmlvbiBDb21tb24uUXVhbGlmaWVkUHJvY2VkdXJlKFsiUHJvY2VkdXJlIjogIkJNSSBGb2xsb3cgVXAgUGxhbiBTTk9NRURDVCJdKQogICAgdW5pb24gQ29tbW9uLlF1YWxpZmllZFByb2NlZHVyZShbIlByb2NlZHVyZSI6ICJBbGNvaG9sIEJyaWVmIEludGVydmVudGlvbiBhbmQgQ291bnNlbGluZyJdKQogICAgdW5pb24gQ29tbW9uLlF1YWxpZmllZFByb2NlZHVyZShbIlByb2NlZHVyZSI6ICJDb3Vuc2VsaW5nIGZvciBOdXRyaXRpb24iXSkKICApIE5vblBoYXJtYWNvbG9naWNhbENvdW5zZWxpbmcKCmRlZmluZSAiQ291bnNlbGluZyBmcm9tIExhc3QgVmlzaXQiOgogICgKICAgIExhc3QoCiAgICAgICJDb3Vuc2VsaW5nIGZvciBOb24tUGhhcm1hY29sb2dpY2FsIEludGVydmVudGlvbnMiIENvdW5zZWxpbmcKICAgICAgc29ydCBieSBzdGFydCBvZiBDb21tb24uIk5vcm1hbGl6ZSBJbnRlcnZhbCIocGVyZm9ybWVkKQogICAgKQogICkgUmVjZW50Q291bnNlbGluZwogICAgcmV0dXJuIFJlY2VudENvdW5zZWxpbmcucmVhc29uUmVmZXJlbmNlCgpkZWZpbmUgIkNvdW5zZWxpbmcgU21va2luZyBPYnNlcnZhdGlvbiI6CiAgTGFzdCgiT2JzZXJ2YXRpb25zIEluZGljYXRpbmcgUGF0aWVudCBpcyBhIFNtb2tlciIgU21va2luZ09ic2VydmVkCiAgICB3aXRoICJDb3Vuc2VsaW5nIGZyb20gTGFzdCBWaXNpdCIgQ291bnNlbGluZwogICAgICBzdWNoIHRoYXQgU21va2luZ09ic2VydmVkLmlkID0gQ29tbW9uLkdldElkKENvdW5zZWxpbmcucmVmZXJlbmNlKSkKCmRlZmluZSAiQ291bnNlbGluZyBEcmlua2luZyBPYnNlcnZhdGlvbiI6CiAgTGFzdCgiT2JzZXJ2YXRpb25zIE1lYXN1cmluZyBBbW91bnQgb2YgQWxjb2hvbGljIERyaW5rcyBQYXRpZW50IGhhcyBwZXIgRHJpbmtpbmcgRGF5IiBEcmlua3NQZXJEYXkKICAgIHdpdGggIkNvdW5zZWxpbmcgZnJvbSBMYXN0IFZpc2l0IiBDb3Vuc2VsaW5nCiAgICAgIHN1Y2ggdGhhdCBEcmlua3NQZXJEYXkuaWQgPSBDb21tb24uR2V0SWQoQ291bnNlbGluZy5yZWZlcmVuY2UpKQoKZGVmaW5lICJDb3Vuc2VsaW5nIEJNSSBPYnNlcnZhdGlvbiI6CiAgTGFzdCgiT2JzZXJ2YXRpb25zIFNwZWNpZnlpbmcgUGF0aWVudCBCTUkiIEJNSU9ic2VydmVkCiAgICB3aXRoICJDb3Vuc2VsaW5nIGZyb20gTGFzdCBWaXNpdCIgQ291bnNlbGluZwogICAgICBzdWNoIHRoYXQgQk1JT2JzZXJ2ZWQuaWQgPSBDb21tb24uR2V0SWQoQ291bnNlbGluZy5yZWZlcmVuY2UpKQoKZGVmaW5lICJQYXRpZW50IFNtb2tpbmcgSW5jcmVhc2VkIFNpbmNlIExhc3QgVmlzaXQiOgogICJQYXRpZW50IGlzIEN1cnJlbnRseSBhIFNtb2tlciIgYW5kICJQYWNrcyBQZXIgRGF5IigiTW9zdCBSZWNlbnQgT2JzZXJ2YXRpb24gb2YgUGF0aWVudCBTbW9raW5nIFN0YXR1cyIpID4gIlBhY2tzIFBlciBEYXkiKCJDb3Vuc2VsaW5nIFNtb2tpbmcgT2JzZXJ2YXRpb24iKQoKZGVmaW5lICJQYXRpZW50IERyaW5raW5nIEluY3JlYXNlZCBTaW5jZSBMYXN0IFZpc2l0IjoKICBmcm9tCiAgICAiTW9zdCBSZWNlbnQgUGF0aWVudCBEcmlua2luZyBPYnNlcnZhdGlvbiIgRHJpbmtpbmdUaGlzVmlzaXQsCiAgICAiQ291bnNlbGluZyBEcmlua2luZyBPYnNlcnZhdGlvbiIgRHJpbmtpbmdMYXN0VmlzaXQKICAgICAgcmV0dXJuIChGSElSSGVscGVycy5Ub1F1YW50aXR5KERyaW5raW5nVGhpc1Zpc2l0LnZhbHVlKSA+IEZISVJIZWxwZXJzLlRvUXVhbnRpdHkoRHJpbmtpbmdMYXN0VmlzaXQudmFsdWUpKSBpcyB0cnVlCgpkZWZpbmUgIlBhdGllbnQgQk1JIEluY3JlYXNlZCBTaW5jZSBMYXN0IFZpc2l0IjoKICBmcm9tCiAgICAiTW9zdCBSZWNlbnQgUGF0aWVudCBCTUkiIEJNSVRoaXNWaXNpdCwKICAgICJDb3Vuc2VsaW5nIEJNSSBPYnNlcnZhdGlvbiIgQk1JTGFzdFZpc2l0CiAgICAgIHJldHVybiAoRkhJUkhlbHBlcnMuVG9RdWFudGl0eShCTUlUaGlzVmlzaXQudmFsdWUpID4gRkhJUkhlbHBlcnMuVG9RdWFudGl0eShCTUlMYXN0VmlzaXQudmFsdWUpKSBpcyB0cnVlCgpkZWZpbmUgIlBhdGllbnQgSGFzIE5vdCBJbmNyZWFzZWQgaW4gU21va2luZywgQk1JLCBPciBEcmlua2luZyBTaW5jZSBMYXN0IENvdW5zZWxpbmciOgogIGlmICJJbiBQb3B1bGF0aW9uIiBpcyBub3QgdHJ1ZQogICAgdGhlbiBmYWxzZQogIGVsc2UgKAogICAgZXhpc3RzICJDb3Vuc2VsaW5nIGZyb20gTGFzdCBWaXNpdCIKICAgICAgYW5kIG5vdCAoCiAgICAgICAgIlBhdGllbnQgU21va2luZyBJbmNyZWFzZWQgU2luY2UgTGFzdCBWaXNpdCIgaXMgdHJ1ZQogICAgICAgIG9yICJQYXRpZW50IERyaW5raW5nIEluY3JlYXNlZCBTaW5jZSBMYXN0IFZpc2l0IiBpcyB0cnVlCiAgICAgICAgb3IgIlBhdGllbnQgQk1JIEluY3JlYXNlZCBTaW5jZSBMYXN0IFZpc2l0IiBpcyB0cnVlCiAgICAgICkKICApCgoKLy8gSXMgUGF0aWVudCBvbiBUcmFjayB0byByZWFjaCBCUCBHb2FsPwpkZWZpbmUgIkJQIEdvYWwgRGVtb25zdHJhdGluZyBQYXRpZW50IEltcHJvdmVtZW50IjoKICAiTW9zdCBSZWNlbnRseSBFc3RhYmxpc2hlZCBCbG9vZCBQcmVzc3VyZSBHb2FsIiBCUEdvYWwKICAgIHdoZXJlIEZISVJIZWxwZXJzLlRvQ29uY2VwdChCUEdvYWwuYWNoaWV2ZW1lbnRTdGF0dXMpIH4gImluLXByb2dyZXNzIgogICAgICBvciBGSElSSGVscGVycy5Ub0NvbmNlcHQoQlBHb2FsLmFjaGlldmVtZW50U3RhdHVzKSB+ICJpbXByb3ZpbmciCiAgICAgIG9yIEZISVJIZWxwZXJzLlRvQ29uY2VwdChCUEdvYWwuYWNoaWV2ZW1lbnRTdGF0dXMpIH4gImFjaGlldmVkIgogICAgICBvciBGSElSSGVscGVycy5Ub0NvbmNlcHQoQlBHb2FsLmFjaGlldmVtZW50U3RhdHVzKSB+ICJzdXN0YWluaW5nIgoKZGVmaW5lICJQYXRpZW50IGF0IEJQIEdvYWwiOgogIGlmICJJbiBQb3B1bGF0aW9uIiBpcyBub3QgdHJ1ZSB0aGVuCiAgICBmYWxzZQogIGVsc2UKICAgICJCUCBHb2FsIERlbW9uc3RyYXRpbmcgUGF0aWVudCBJbXByb3ZlbWVudCIgaXMgbm90IG51bGwKCgovKiBBY3Rpb24gQ29uZGl0aW9uYWxzICovCmRlZmluZSAiUGF0aWVudCBpcyBDdXJyZW50bHkgYSBTbW9rZXIgQWN0aW9uIFBhdGgiOgogIGlmICJJbiBQb3B1bGF0aW9uIiBpcyBub3QgdHJ1ZSB0aGVuCiAgICBmYWxzZQogIGVsc2Ugbm90ICJQYXRpZW50IEhhcyBOb3QgSW5jcmVhc2VkIGluIFNtb2tpbmcsIEJNSSwgT3IgRHJpbmtpbmcgU2luY2UgTGFzdCBDb3Vuc2VsaW5nIgogICAgYW5kICgiUGF0aWVudCBpcyBDdXJyZW50bHkgYSBTbW9rZXIiIGlzIHRydWUpCgpkZWZpbmUgIlBhdGllbnQgQk1JIGlzIEdyZWF0ZXIgdGhhbiAyNSBrZy9tMiBBY3Rpb24gUGF0aCI6CiAgaWYgIkluIFBvcHVsYXRpb24iIGlzIG5vdCB0cnVlIHRoZW4KICAgIGZhbHNlCiAgZWxzZSBub3QgIlBhdGllbnQgSGFzIE5vdCBJbmNyZWFzZWQgaW4gU21va2luZywgQk1JLCBPciBEcmlua2luZyBTaW5jZSBMYXN0IENvdW5zZWxpbmciCiAgICBhbmQgKCJQYXRpZW50IEJNSSBpcyBHcmVhdGVyIHRoYW4gMjUga2cvbTIiIGlzIHRydWUpCgpkZWZpbmUgIlBhdGllbnQgaXMgYSBIZWF2eSBBbGNvaG9saWMgRHJpbmtlciBBY3Rpb24gUGF0aCI6CiAgaWYgIkluIFBvcHVsYXRpb24iIGlzIG5vdCB0cnVlIHRoZW4KICAgIGZhbHNlCiAgZWxzZSBub3QgIlBhdGllbnQgSGFzIE5vdCBJbmNyZWFzZWQgaW4gU21va2luZywgQk1JLCBPciBEcmlua2luZyBTaW5jZSBMYXN0IENvdW5zZWxpbmciCiAgICBhbmQgKCJQYXRpZW50IGlzIGEgSGVhdnkgQWxjb2hvbGljIERyaW5rZXIiIGlzIHRydWUpCgpkZWZpbmUgIlBhdGllbnQgaXMgaW4gTmVlZCBvZiBEaWV0YXJ5IENvdW5zZWxpbmcgQWN0aW9uIFBhdGgiOgogIGlmICJJbiBQb3B1bGF0aW9uIiBpcyBub3QgdHJ1ZSB0aGVuCiAgICBmYWxzZQogIGVsc2Ugbm90IGV4aXN0cyAiQ291bnNlbGluZyBmb3IgTm9uLVBoYXJtYWNvbG9naWNhbCBJbnRlcnZlbnRpb25zIgogICAgb3IgKG5vdCAiUGF0aWVudCBIYXMgTm90IEluY3JlYXNlZCBpbiBTbW9raW5nLCBCTUksIE9yIERyaW5raW5nIFNpbmNlIExhc3QgQ291bnNlbGluZyIgaXMgdHJ1ZSkKCmRlZmluZSAiUGF0aWVudCBSZW1pbmRlciBSZWNvbW1lbmRhdGlvbnMgQWN0aW9uIFBhdGgiOgogIGlmICJJbiBQb3B1bGF0aW9uIiBpcyBub3QgdHJ1ZSB0aGVuCiAgICBmYWxzZQogIGVsc2UgIlBhdGllbnQgSGFzIE5vdCBJbmNyZWFzZWQgaW4gU21va2luZywgQk1JLCBPciBEcmlua2luZyBTaW5jZSBMYXN0IENvdW5zZWxpbmciIGlzIHRydWUKCgovKiBFeGNsdXNpb24gQ3JpdGVyaWEgKi8KZGVmaW5lICJQYXRpZW50IFVuZGVyIEFnZSAxOCI6CiAgQWdlSW5ZZWFyc0F0KFRvZGF5KCkpIDwgMTgKCmRlZmluZSAiUGF0aWVudCBPdmVyIEFnZSA4MCI6CiAgQWdlSW5ZZWFyc0F0KFRvZGF5KCkpID4gODAKCmRlZmluZSAiQ29uZGl0aW9uIEluZGljYXRpbmcgRW5kIFN0YWdlIFJlbmFsIERpc2Vhc2UiOgogIChDb21tb24uUXVhbGlmaWVkQ29uZGl0aW9uKFsiQ29uZGl0aW9uIjogIkVuZCBTdGFnZSBSZW5hbCBEaXNlYXNlIl0pKSBFU1JECgpkZWZpbmUgIkNvbmRpdGlvbiBJbmRpY2F0aW5nIFByZWduYW5jeSI6CiAgKENvbW1vbi5RdWFsaWZpZWRDb25kaXRpb24oWyJDb25kaXRpb24iOiAiUHJlZ25hbmN5Il0pKSBQcmVnbmFuY3kKICAgIHdoZXJlIGVuZCBvZiBDb21tb24uIlByZXZhbGVuY2UgUGVyaW9kIihQcmVnbmFuY3kpID4gVG9kYXkoKQoKLyogVEVTVCAqLwpkZWZpbmUgIlRFU1QgUGF0aWVudCBBZ2UiOgogIEFnZUluWWVhcnMoKQoKZGVmaW5lICJURVNUIFBhdGllbnQgQk1JIFJlc291cmNlcyI6CiAgIk9ic2VydmF0aW9ucyBTcGVjaWZ5aW5nIFBhdGllbnQgQk1JIi5pZAoKZGVmaW5lICJURVNUIE1vc3QgUmVjZW50IFBhdGllbnQgQk1JIjoKICAiTW9zdCBSZWNlbnQgUGF0aWVudCBCTUkiIEJNSQogICAgcmV0dXJuIFR1cGxlIHsKICAgICAgIklEIjogQk1JLmlkLAogICAgICAiRGF0ZSI6IEJNSS5lZmZlY3RpdmUuZW5kLAogICAgICAiVmFsdWUiOiBCTUkudmFsdWUudmFsdWUsCiAgICAgICJVbml0IjogQk1JLnZhbHVlLnVuaXQKICAgIH0KCmRlZmluZSAiVEVTVCBQYXRpZW50IFBhY2tzIFBlciBEYXkgTW9zdCBSZWNlbnQiOgogICJQYWNrcyBQZXIgRGF5IigiTW9zdCBSZWNlbnQgT2JzZXJ2YXRpb24gb2YgUGF0aWVudCBTbW9raW5nIFN0YXR1cyIpCgpkZWZpbmUgIlRFU1QgUGF0aWVudCBQYWNrcyBQZXIgRGF5IEF0IENvdW5zZWxpbmciOgogICJQYWNrcyBQZXIgRGF5IigiQ291bnNlbGluZyBTbW9raW5nIE9ic2VydmF0aW9uIikK"
  }]
}
